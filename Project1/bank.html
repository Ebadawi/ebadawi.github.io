<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Veem Bank Collection Plugin</title>
  <!-- Include the Veem Web SDK -->
  <script src="https://unpkg.com/veem-web-sdk@^0/umd/index.min.js" type="application/javascript"></script>
  <!-- Include Roboto font for styling -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      margin: 40px;
      background-color: #f9f9f9;
    }
    #veem-collect-bank {
      max-width: 500px;
      margin: 0 auto;
    }
  </style>
</head>
<body>
  <h2>Collect Bank Account Information</h2>
  <!-- Container where the Veem plugin will be mounted -->
  <div id="veem-collect-bank"></div>

  <script>
    // Initialize the Veem Web SDK
    new Veem.WebSDK({
      name: 'collectAccountInformation',
      environment: 'sandbox', // Change to 'production' for live
      target: '#veem-collect-bank',

      onExit: () => {
        alert('User exited the bank collection flow.');
      },

      onError: (err) => {
        console.error('Veem Plugin Error:', err);
        alert('An error occurred: ' + JSON.stringify(err));
      },

      onComplete: ({ referenceId, preset, userInputs }) => {
        // Updated structure from latest documentation
        const { paymentMethod } = userInputs || {};
        const fundingId = paymentMethod?.fundingMethod?.id;
        const accountMasked = paymentMethod?.accountNumber;
        const fullName = paymentMethod?.name;
        const type = paymentMethod?.type;

        const address = paymentMethod?.address || {};

        const summary = `
          Reference ID: ${referenceId}
          Funding Method ID: ${fundingId}
          Type: ${type}
          Name: ${fullName}
          Account (masked): ${accountMasked}
          Address: ${address.street}, ${address.city}, ${address.stateProvince}, ${address.postalCode}, ${address.countryCode}
        `;

        alert(summary);
      },

      referenceId: 'bankRef123', // Should be unique per session

      preset: {
        amount: 500,
        currencyCode: 'USD',
      },

      configuration: {
        accountId: 973226, // ðŸ”„ Replace with actual account ID from /customers API
        sessionSecret: 'b45091d6550ec6656bb0a294b5859057', // ðŸ”„ Replace with actual sessionSecret
        clientId: 'testQAwhish-5XG09EeqyV', // ðŸ”„ Replace with your registered client ID
        paymentOptions: [
          { type: 'Bank', header: 'Link your Bank Account' }
        ],
        style: {
          typography: {
            fontFamily: 'Roboto',
            color: '#1A1A1A',
            weight: 400,
            fontSize: 14,
            error: {
              fontFamily: 'Roboto',
              fontSize: 14,
              weight: 400,
              color: '#B6353B',
            },
          },
          header: {
            fontFamily: 'Roboto',
            fontSize: 22,
            weight: 700,
          },
          input: {
            backgroundColor: '#FFF',
            borderColor: '#B0B7BF',
            placeholderColor: '#B0B7BF',
            height: 36,
            borderRadius: 2,
            paddingTop: 8,
            paddingRight: 8,
            paddingBottom: 8,
            paddingLeft: 16,
            error: {
              backgroundColor: '#FFEBEC',
              borderColor: '#B6353B',
              placeholderColor: '#B0B7BF',
              height: 36,
              borderRadius: 2,
              paddingTop: 8,
              paddingRight: 8,
              paddingBottom: 8,
              paddingLeft: 16,
            },
          },
          button: {
            height: 40,
            minWidth: 100,
            padding: {
              top: 10,
              right: 24,
              bottom: 10,
              left: 24,
            },
            textTransform: 'capitalize',
            backgroundColor: '#1A1A1A',
            color: '#FFF',
            fontFamily: 'Roboto',
            fontSize: 16,
            weight: 600,
            borderRadius: 4,
            border: {
              color: '#1A1A1A',
              width: 1,
              style: 'solid',
            },
            hover: {
              backgroundColor: '#333333',
              color: '#FFF',
            },
            disabled: {
              backgroundColor: '#E0E0E0',
              color: '#B0B7BF',
            },
          },
        },
      },
    });
  </script>
</body>
</html>
